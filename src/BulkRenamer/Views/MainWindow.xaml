<Window x:Class="BulkRenamer.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:enums="clr-namespace:BulkRenamer.Core.Enums"
        xmlns:models="clr-namespace:BulkRenamer.Core.Models"
        Title="Bulk Renamer"
        MinWidth="820" MinHeight="540"
        Width="900"   Height="620"
        Background="#1E1E1E">

    <Window.Resources>

        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize"   Value="12"/>
            <Setter Property="Margin"     Value="0,0,0,6"/>
        </Style>

        <Style x:Key="PanelBox" TargetType="Border">
            <Setter Property="Background"   Value="#2D2D2D"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding"      Value="12"/>
            <Setter Property="Margin"       Value="0,0,0,10"/>
        </Style>

        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="Foreground"        Value="#999999"/>
            <Setter Property="FontSize"          Value="11"/>
            <Setter Property="Width"             Value="120"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background"  Value="#3C3C3C"/>
            <Setter Property="Foreground"  Value="#EEEEEE"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Padding"     Value="6,4"/>
            <Setter Property="FontSize"    Value="12"/>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="Foreground"        Value="#CCCCCC"/>
            <Setter Property="FontSize"          Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background"      Value="#0E639C"/>
            <Setter Property="Foreground"      Value="White"/>
            <Setter Property="FontSize"        Value="12"/>
            <Setter Property="FontWeight"      Value="SemiBold"/>
            <Setter Property="Padding"         Value="16,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"   Value="False"><Setter Property="Opacity"    Value="0.4"/></Trigger>
                            <Trigger Property="IsMouseOver" Value="True"> <Setter Property="Background" Value="#1177BB"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background"      Value="#3C3C3C"/>
            <Setter Property="Foreground"      Value="#CCCCCC"/>
            <Setter Property="FontSize"        Value="12"/>
            <Setter Property="Padding"         Value="16,8"/>
            <Setter Property="BorderBrush"     Value="#555555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor"          Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True"><Setter Property="Background" Value="#4A4A4A"/></Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="#555555" BorderThickness="1" CornerRadius="3">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                </Grid.ColumnDefinitions>
                                <Rectangle Grid.Column="0" Fill="Transparent"/>
                                <TextBlock Grid.Column="1" Text="▾" Foreground="#AAAAAA"
                                           VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Background"  Value="#3C3C3C"/>
            <Setter Property="Foreground"  Value="#EEEEEE"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="FontSize"    Value="12"/>
            <Setter Property="Cursor"      Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Style="{StaticResource ComboBoxToggleButton}"
                                          Background="{TemplateBinding Background}"
                                          IsChecked="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                                          Focusable="False"/>
                            <ContentPresenter Content="{TemplateBinding SelectionBoxItem}"
                                              Margin="8,0,24,0" VerticalAlignment="Center"
                                              IsHitTestVisible="False"
                                              TextBlock.Foreground="#EEEEEE"/>
                            <Popup IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True" Placement="Bottom" StaysOpen="False">
                                <Border Background="#3C3C3C" BorderBrush="#555555" BorderThickness="1"
                                        MaxHeight="200" MinWidth="{TemplateBinding ActualWidth}">
                                    <ScrollViewer><ItemsPresenter/></ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Resources>
                <Style TargetType="ComboBoxItem">
                    <Setter Property="Background" Value="#3C3C3C"/>
                    <Setter Property="Foreground" Value="#EEEEEE"/>
                    <Setter Property="Padding"    Value="8,5"/>
                    <Setter Property="Cursor"     Value="Hand"/>
                    <Style.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter Property="Background" Value="#0E639C"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Style.Resources>
        </Style>

    </Window.Resources>

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="12"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- SCOPE -->
                <TextBlock Text="SCOPE" Style="{StaticResource SectionHeader}"/>
                <Border Style="{StaticResource PanelBox}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="Folder" Style="{StaticResource FieldLabel}"/>
                            <TextBox Text="{Binding FolderPath, UpdateSourceTrigger=PropertyChanged}"
                                     Width="110" Margin="0,0,6,0"/>
                            <Button Content="..." Style="{StaticResource SecondaryButton}"
                                    Command="{Binding BrowseFolderCommand}" Padding="10,4"/>
                        </StackPanel>
                        <CheckBox Content="Include Subfolders"
                                  IsChecked="{Binding IncludeSubfolders}"
                                  Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Extensions" Style="{StaticResource FieldLabel}"/>
                            <TextBox Width="140"
                                     Text="{Binding ExtensionFilter, UpdateSourceTrigger=PropertyChanged}"
                                     ToolTip="Comma-separated e.g: .mp3, .wav — empty means all files"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- FILTER -->
                <TextBlock Text="FILTER" Style="{StaticResource SectionHeader}"/>
                <Border Style="{StaticResource PanelBox}">
                    <StackPanel>
                        <CheckBox Content="Use Filter" IsChecked="{Binding UseFilter}" Margin="0,0,0,8"/>
                        <StackPanel IsEnabled="{Binding UseFilter}">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                <TextBlock Text="Match" Style="{StaticResource FieldLabel}"/>
                                <ComboBox Width="140"
                                          ItemsSource="{Binding Source={x:Static enums:MatchModeItems.All}}"
                                          SelectedItem="{Binding FilterMatch}"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Text" Style="{StaticResource FieldLabel}"/>
                                <TextBox Width="140"
                                         Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- REPLACE -->
                <TextBlock Text="REPLACE" Style="{StaticResource SectionHeader}"/>
                <Border Style="{StaticResource PanelBox}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Mode" Style="{StaticResource FieldLabel}"/>
                            <ComboBox Width="140"
                                      ItemsSource="{Binding Source={x:Static enums:ReplaceModeItems.All}}"
                                      SelectedItem="{Binding ReplaceMode}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Apply To" Style="{StaticResource FieldLabel}"/>
                            <ComboBox Width="140"
                                      ItemsSource="{Binding Source={x:Static enums:ApplyModeItems.All}}"
                                      SelectedItem="{Binding ApplyMode}"/>
                        </StackPanel>
                        <CheckBox Content="Case Sensitive"
                                  IsChecked="{Binding CaseSensitive}"
                                  Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Find" Style="{StaticResource FieldLabel}"/>
                            <TextBox Width="140"
                                     Text="{Binding FindText, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="Replace With" Style="{StaticResource FieldLabel}"/>
                            <TextBox Width="140"
                                     Text="{Binding ReplaceText, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>

                        <!-- Divider -->
                        <Border BorderBrush="#444444" BorderThickness="0,1,0,0" Margin="0,0,0,10"/>

                        <!-- Whitespace replace -->
                        <CheckBox Content="Replace Spaces"
                                  IsChecked="{Binding ReplaceWhitespace}"
                                  Margin="0,0,0,6"/>
                        <StackPanel Orientation="Horizontal"
                                    IsEnabled="{Binding ReplaceWhitespace}">
                            <TextBlock Text="Replace With" Style="{StaticResource FieldLabel}"/>
                            <TextBox Width="80"
                                     Text="{Binding WhitespaceReplacement, UpdateSourceTrigger=PropertyChanged}"
                                     ToolTip="String to replace each space with e.g. _ or -"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- SAFETY -->
                <TextBlock Text="SAFETY" Style="{StaticResource SectionHeader}"/>
                <Border Style="{StaticResource PanelBox}">
                    <StackPanel>
                        <CheckBox Content="Preview Only (Dry Run)"
                                  IsChecked="{Binding PreviewOnly}"
                                  Margin="0,0,0,6"/>
                        <CheckBox Content="Skip If No Change"
                                  IsChecked="{Binding SkipIfNoChange}"
                                  Margin="0,0,0,6"/>
                        <CheckBox Content="Skip If Name Collision"
                                  IsChecked="{Binding SkipIfNameCollision}"/>
                    </StackPanel>
                </Border>

                <!-- ACTION BUTTONS -->
                <StackPanel Orientation="Horizontal">
                    <Button Content="Rebuild Preview"
                            Style="{StaticResource SecondaryButton}"
                            Command="{Binding RebuildPreviewCommand}"
                            Margin="0,0,8,0"/>
                    <Button Content="Apply Rename"
                            Style="{StaticResource PrimaryButton}"
                            Command="{Binding ApplyRenameCommand}"/>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>

        <!-- RIGHT PANEL — Preview List -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="PREVIEW" Style="{StaticResource SectionHeader}"/>

            <Border Grid.Row="1" Background="#2D2D2D" CornerRadius="4">
                <ListView ItemsSource="{Binding Previews}"
                          Background="Transparent" BorderThickness="0"
                          Foreground="#EEEEEE" FontSize="12">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Old Name" Width="220"
                                            DisplayMemberBinding="{Binding OldName}"/>
                            <GridViewColumn Header="New Name" Width="220"
                                            DisplayMemberBinding="{Binding NewName}"/>
                            <GridViewColumn Header="Status"   Width="100"
                                            DisplayMemberBinding="{Binding Status}"/>
                        </GridView>
                    </ListView.View>
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="#EEEEEE"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Status}" Value="{x:Static models:RenamePreviewStatus.WillRename}">
                                    <Setter Property="Foreground" Value="#89D185"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="{x:Static models:RenamePreviewStatus.Collision}">
                                    <Setter Property="Foreground" Value="#F14C4C"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="{x:Static models:RenamePreviewStatus.NoChange}">
                                    <Setter Property="Foreground" Value="#666666"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                </ListView>
            </Border>

            <Border Grid.Row="2" Background="#252525" CornerRadius="4"
                    Padding="10,6" Margin="0,8,0,0">
                <TextBlock Text="{Binding StatusMessage}" Foreground="#999999" FontSize="11"/>
            </Border>
        </Grid>
    </Grid>
</Window>
